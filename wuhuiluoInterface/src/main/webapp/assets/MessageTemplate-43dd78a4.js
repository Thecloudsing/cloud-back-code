import{r as l,a as _,b as We,R as C,_ as Ve,d as oe,t as vt,e as re,K as E,f as gt,h as De,i as mt,k as xt,l as ht,S as Le,j as S}from"./index-b467bab1.js";import{E as bt,m as St}from"./Editable-84dcc714.js";import{B as Ct,T as yt,i as wt,g as It,b as Et,c as _t,d as Ot,e as Pt,f as Nt,F as Mt,D as Tt,h as $t,j as jt,a as ae,S as ze}from"./api-5f1978fd.js";import{T as Ft,u as Rt}from"./index-e377c6e8.js";import{E as At,a as Ke}from"./index-6f80cc29.js";function kt(){var e=l.useState({id:0,callback:null}),t=_(e,2),s=t[0],a=t[1],o=l.useCallback(function(i){a(function(n){var u=n.id;return{id:u+1,callback:i}})},[]);return l.useEffect(function(){var i;(i=s.callback)===null||i===void 0||i.call(s)},[s]),o}var He=l.createContext(null);function Bt(e){var t=l.useContext(He),s=t.notFoundContent,a=t.activeIndex,o=t.setActiveIndex,i=t.selectOption,n=t.onFocus,u=t.onBlur,v=e.prefixCls,f=e.options,m=f[a]||{};return l.createElement(At,{prefixCls:"".concat(v,"-menu"),activeKey:m.key,onSelect:function(y){var g=y.key,h=f.find(function(b){var w=b.key;return w===g});i(h)},onFocus:n,onBlur:u},f.map(function(x,y){var g=x.key,h=x.disabled,b=x.className,w=x.style,O=x.label;return l.createElement(Ke,{key:g,disabled:h,className:b,style:w,onMouseEnter:function(){o(y)}},O)}),!f.length&&l.createElement(Ke,{disabled:!0},s))}var Dt={bottomRight:{points:["tl","br"],offset:[0,4],overflow:{adjustX:1,adjustY:1}},bottomLeft:{points:["tr","bl"],offset:[0,4],overflow:{adjustX:1,adjustY:1}},topRight:{points:["bl","tr"],offset:[0,-4],overflow:{adjustX:1,adjustY:1}},topLeft:{points:["br","tl"],offset:[0,-4],overflow:{adjustX:1,adjustY:1}}},Lt=function(t){var s=t.prefixCls,a=t.options,o=t.children,i=t.visible,n=t.transitionName,u=t.getPopupContainer,v=t.dropdownClassName,f=t.direction,m=t.placement,x="".concat(s,"-dropdown"),y=l.createElement(Bt,{prefixCls:x,options:a}),g=l.useMemo(function(){var h;return f==="rtl"?h=m==="top"?"topLeft":"bottomLeft":h=m==="top"?"topRight":"bottomRight",h},[f,m]);return l.createElement(Ft,{prefixCls:x,popupVisible:i,popup:y,popupPlacement:g,popupTransitionName:n,builtinPlacements:Dt,getPopupContainer:u,popupClassName:v},o)},zt=function(){return null};function Kt(e){var t=e.selectionStart;return e.value.slice(0,t)}function Ut(e,t){return t.reduce(function(s,a){var o=e.lastIndexOf(a);return o>s.location?{location:o,prefix:a}:s},{location:-1,prefix:""})}function Ue(e){return(e||"").toLowerCase()}function Wt(e,t,s){var a=e[0];if(!a||a===s)return e;for(var o=e,i=t.length,n=0;n<i;n+=1)if(Ue(o[n])!==Ue(t[n])){o=o.slice(n);break}else n===i-1&&(o=o.slice(i));return o}function Vt(e,t){var s=t.measureLocation,a=t.prefix,o=t.targetText,i=t.selectionStart,n=t.split,u=e.slice(0,s);u[u.length-n.length]===n&&(u=u.slice(0,u.length-n.length)),u&&(u="".concat(u).concat(n));var v=Wt(e.slice(i),o.slice(i-s-a.length),n);v.slice(0,n.length)===n&&(v=v.slice(n.length));var f="".concat(u).concat(a).concat(o).concat(n);return{text:"".concat(f).concat(v),selectionLocation:f.length}}function Ht(e,t){e.setSelectionRange(t,t),e.blur(),e.focus()}function Xt(e,t){return!t||e.indexOf(t)===-1}function Yt(e,t){var s=t.value,a=s===void 0?"":s,o=e.toLowerCase();return a.toLowerCase().indexOf(o)!==-1}var Gt=["prefixCls","className","style","prefix","split","notFoundContent","value","defaultValue","children","options","open","validateSearch","filterOption","onChange","onKeyDown","onKeyUp","onPressEnter","onSearch","onSelect","onFocus","onBlur","transitionName","placement","direction","getPopupContainer","dropdownClassName","rows"],qt=["suffix","prefixCls","classes","value"],Jt=l.forwardRef(function(e,t){var s=e.prefixCls,a=s===void 0?"rc-mentions":s,o=e.className,i=e.style,n=e.prefix,u=n===void 0?"@":n,v=e.split,f=v===void 0?" ":v,m=e.notFoundContent,x=m===void 0?"Not Found":m,y=e.value,g=e.defaultValue,h=e.children,b=e.options,w=e.open,O=e.validateSearch,H=O===void 0?Xt:O,N=e.filterOption,$=N===void 0?Yt:N,B=e.onChange,j=e.onKeyDown,D=e.onKeyUp,X=e.onPressEnter,Y=e.onSearch,L=e.onSelect,G=e.onFocus,z=e.onBlur,se=e.transitionName,le=e.placement,P=e.direction,ue=e.getPopupContainer,K=e.dropdownClassName,q=e.rows,ce=q===void 0?1:q,Xe=We(e,Gt),J=Array.isArray(u)?u:[u],U=l.useRef(null),de=l.useRef(null),fe=function(){var r,c;return(r=U.current)===null||r===void 0||(c=r.resizableTextArea)===null||c===void 0?void 0:c.textArea};C.useImperativeHandle(t,function(){var p,r;return{focus:function(){var d;return(d=U.current)===null||d===void 0?void 0:d.focus()},blur:function(){var d;return(d=U.current)===null||d===void 0?void 0:d.blur()},textarea:(p=U.current)===null||p===void 0||(r=p.resizableTextArea)===null||r===void 0?void 0:r.textArea}});var Ye=l.useState(!1),be=_(Ye,2),Q=be[0],Se=be[1],Ge=l.useState(""),Ce=_(Ge,2),ye=Ce[0],we=Ce[1],qe=l.useState(""),Ie=_(qe,2),Ee=Ie[0],Je=Ie[1],Qe=l.useState(0),_e=_(Qe,2),Oe=_e[0],Pe=_e[1],Ze=l.useState(0),Ne=_(Ze,2),pe=Ne[0],ve=Ne[1],et=l.useState(!1),Me=_(et,2),tt=Me[0],Te=Me[1],nt=Rt("",{defaultValue:g,value:y}),$e=_(nt,2),F=$e[0],ot=$e[1];l.useEffect(function(){Q&&de.current&&(de.current.scrollTop=fe().scrollTop)},[Q]);var at=C.useMemo(function(){if(w)for(var p=0;p<J.length;p+=1){var r=J[p],c=F.lastIndexOf(r);if(c>=0)return[!0,"",r,c]}return[Q,ye,Ee,Oe]},[w,Q,J,F,ye,Ee,Oe]),Z=_(at,4),R=Z[0],ge=Z[1],ee=Z[2],me=Z[3],xe=C.useCallback(function(p){var r;return b&&b.length>0?r=b.map(function(c){var d;return oe(oe({},c),{},{key:(d=c==null?void 0:c.key)!==null&&d!==void 0?d:c.value})}):r=vt(h).map(function(c){var d=c.props,M=c.key;return oe(oe({},d),{},{label:d.children,key:M||d.value})}),r.filter(function(c){return $===!1?!0:$(p,c)})},[h,b,$]),te=C.useMemo(function(){return xe(ge)},[xe,ge]),rt=kt(),it=function(r,c,d){Se(!0),we(r),Je(c),Pe(d),ve(0)},A=function(r){Se(!1),Pe(0),we(""),rt(r)},je=function(r){ot(r),B==null||B(r)},st=function(r){var c=r.target.value;je(c)},Fe=function(r){var c,d=r.value,M=d===void 0?"":d,T=Vt(F,{measureLocation:me,targetText:M,prefix:ee,selectionStart:(c=fe())===null||c===void 0?void 0:c.selectionStart,split:f}),k=T.text,W=T.selectionLocation;je(k),A(function(){Ht(fe(),W)}),L==null||L(r,ee)},lt=function(r){var c=r.which;if(j==null||j(r),!!R){if(c===E.UP||c===E.DOWN){var d=te.length,M=c===E.UP?-1:1,T=(pe+M+d)%d;ve(T),r.preventDefault()}else if(c===E.ESC)A();else if(c===E.ENTER){if(r.preventDefault(),!te.length){A();return}var k=te[pe];Fe(k)}}},ut=function(r){var c=r.key,d=r.which,M=r.target,T=Kt(M),k=Ut(T,J),W=k.location,ne=k.prefix;if(D==null||D(r),[E.ESC,E.UP,E.DOWN,E.ENTER].indexOf(d)===-1)if(W!==-1){var V=T.slice(W+ne.length),Be=H(V,f),pt=!!xe(V).length;Be?(c===ne||c==="Shift"||R||V!==ge&&pt)&&it(V,ne,W):R&&A(),Y&&Be&&Y(V,ne)}else R&&A()},ct=function(r){!R&&X&&X(r)},Re=l.useRef(),Ae=function(r){window.clearTimeout(Re.current),!tt&&r&&G&&G(r),Te(!0)},ke=function(r){Re.current=window.setTimeout(function(){Te(!1),A(),z==null||z(r)},0)},dt=function(){Ae()},ft=function(){ke()};return C.createElement("div",{className:re(a,o),style:i},C.createElement(yt,Ve({ref:U,value:F},Xe,{rows:ce,onChange:st,onKeyDown:lt,onKeyUp:ut,onPressEnter:ct,onFocus:Ae,onBlur:ke})),R&&C.createElement("div",{ref:de,className:"".concat(a,"-measure")},F.slice(0,me),C.createElement(He.Provider,{value:{notFoundContent:x,activeIndex:pe,setActiveIndex:ve,selectOption:Fe,onFocus:dt,onBlur:ft}},C.createElement(Lt,{prefixCls:a,transitionName:se,placement:le,direction:P,options:te,visible:!0,getPopupContainer:ue,dropdownClassName:K},C.createElement("span",null,ee))),F.slice(me+ee.length)))}),he=l.forwardRef(function(e,t){var s=e.suffix,a=e.prefixCls,o=e.classes,i=e.value,n=We(e,qt);return C.createElement(Ct,{inputElement:C.createElement(Jt,Ve({prefixCls:a,ref:t},n)),suffix:s,prefixCls:a,classes:o,value:i})});he.Option=zt;const Qt=e=>{const{componentCls:t,colorTextDisabled:s,controlItemBgHover:a,controlPaddingHorizontal:o,colorText:i,motionDurationSlow:n,lineHeight:u,controlHeight:v,inputPaddingHorizontal:f,inputPaddingVertical:m,fontSize:x,colorBgElevated:y,paddingXXS:g,borderRadius:h,borderRadiusLG:b,boxShadowSecondary:w}=e,O=Math.round((e.controlHeight-e.fontSize*e.lineHeight)/2);return{[t]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},De(e)),It(e)),{position:"relative",display:"inline-block",height:"auto",padding:0,overflow:"hidden",lineHeight:u,whiteSpace:"pre-wrap",verticalAlign:"bottom"}),Et(e,t)),{"&-disabled":{"> textarea":Object.assign({},_t(e))},"&-focused":Object.assign({},Ot(e)),[`&-affix-wrapper ${t}-suffix`]:{position:"absolute",top:0,insetInlineEnd:f,bottom:0,zIndex:1,display:"inline-flex",alignItems:"center",margin:"auto"},[`> textarea, ${t}-measure`]:{color:i,boxSizing:"border-box",minHeight:v-2,margin:0,padding:`${m}px ${f}px`,overflow:"inherit",overflowX:"hidden",overflowY:"auto",fontWeight:"inherit",fontSize:"inherit",fontFamily:"inherit",fontStyle:"inherit",fontVariant:"inherit",fontSizeAdjust:"inherit",fontStretch:"inherit",lineHeight:"inherit",direction:"inherit",letterSpacing:"inherit",whiteSpace:"inherit",textAlign:"inherit",verticalAlign:"top",wordWrap:"break-word",wordBreak:"inherit",tabSize:"inherit"},"> textarea":Object.assign({width:"100%",border:"none",outline:"none",resize:"none",backgroundColor:"inherit"},Pt(e.colorTextPlaceholder)),[`${t}-measure`]:{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,zIndex:-1,color:"transparent",pointerEvents:"none","> span":{display:"inline-block",minHeight:"1em"}},"&-dropdown":Object.assign(Object.assign({},De(e)),{position:"absolute",top:-9999,insetInlineStart:-9999,zIndex:e.zIndexPopup,boxSizing:"border-box",fontSize:x,fontVariant:"initial",padding:g,backgroundColor:y,borderRadius:b,outline:"none",boxShadow:w,"&-hidden":{display:"none"},[`${t}-dropdown-menu`]:{maxHeight:e.dropdownHeight,margin:0,paddingInlineStart:0,overflow:"auto",listStyle:"none",outline:"none","&-item":Object.assign(Object.assign({},mt),{position:"relative",display:"block",minWidth:e.controlItemWidth,padding:`${O}px ${o}px`,color:i,borderRadius:h,fontWeight:"normal",lineHeight:u,cursor:"pointer",transition:`background ${n} ease`,"&:hover":{backgroundColor:a},"&-disabled":{color:s,cursor:"not-allowed","&:hover":{color:s,backgroundColor:a,cursor:"not-allowed"}},"&-selected":{color:i,fontWeight:e.fontWeightStrong,backgroundColor:a},"&-active":{backgroundColor:a}})}})})}},Zt=gt("Mentions",e=>{const t=wt(e);return[Qt(t)]},e=>({dropdownHeight:250,controlItemWidth:100,zIndexPopup:e.zIndexPopupBase+50}));var en=globalThis&&globalThis.__rest||function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(s[a[o]]=e[a[o]]);return s};const{Option:I}=he;function tn(){return!0}const nn=(e,t)=>{var{prefixCls:s,className:a,rootClassName:o,disabled:i,loading:n,filterOption:u,children:v,notFoundContent:f,options:m,status:x,popupClassName:y}=e,g=en(e,["prefixCls","className","rootClassName","disabled","loading","filterOption","children","notFoundContent","options","status","popupClassName"]);const[h,b]=l.useState(!1),w=l.useRef(null),O=xt(t,w),{getPrefixCls:H,renderEmpty:N,direction:$}=l.useContext(ht),{status:B,hasFeedback:j,feedbackIcon:D}=l.useContext(Mt),X=jt(B,x),Y=function(){g.onFocus&&g.onFocus.apply(g,arguments),b(!0)},L=function(){g.onBlur&&g.onBlur.apply(g,arguments),b(!1)},G=l.useMemo(()=>f!==void 0?f:(N==null?void 0:N("Select"))||l.createElement(Tt,{componentName:"Select"}),[f,N]),z=l.useMemo(()=>n?l.createElement(I,{value:"ANTD_SEARCHING",disabled:!0},l.createElement(Le,{size:"small"})):v,[n,v]),se=n?[{value:"ANTD_SEARCHING",disabled:!0,label:l.createElement(Le,{size:"small"})}]:m,le=n?tn:u,P=H("mentions",s),[ue,K]=Zt(P),q=re({[`${P}-disabled`]:i,[`${P}-focused`]:h,[`${P}-rtl`]:$==="rtl"},$t(P,X),!j&&a,o,K),ce=l.createElement(he,Object.assign({prefixCls:P,notFoundContent:G,className:q,disabled:i,direction:$},g,{filterOption:le,onFocus:Y,onBlur:L,dropdownClassName:re(y,o,K),ref:O,options:se,suffix:j&&D,classes:{affixWrapper:re(K,a)}}),z);return ue(ce)},ie=l.forwardRef(nn);ie.Option=I;const on=Nt(ie,"mentions");ie._InternalPanelDoNotUseOrYouWillBeFired=on;ie.getMentions=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{prefix:s="@",split:a=" "}=t,o=Array.isArray(s)?s:[s];return e.split(a).map(function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=null;return o.some(u=>i.slice(0,u.length)===u?(n=u,!0):!1),n!==null?{prefix:n,value:i.slice(n.length)}:null}).filter(i=>!!i&&!!i.value)};const cn=()=>{const[e,t]=l.useState("UTF-8"),[s,a]=l.useState("text");return S.jsx(bt,{otherColumns:St,request:(o,i,n,u,v,f)=>{i(!0),ae({type:"selMessageList",body:{url:`/message.do?operate=selMessageList&page=${n}&limit=${u}&like=${f||""}&encode=${e||""}&type=${s||""}`},then(m){o(m.data),v(m.totalCount)},_finally_(){i(!1)}})},update:(o,i,n)=>{n(!0),ae({type:"updateMessage",enableNotifications:!0,message:"更新成功",body:{url:"/message.do?operate=updateMessage",method:"post",params:o},then(u){i(u.data)},_finally_(){n(!1)}})},add:(o,i,n)=>{n(!0),ae({type:"addMessage",enableNotifications:!0,message:"添加成功",body:{url:"/message.do?operate=addMessage",method:"post",params:o},then(u){i(u.data)},_finally_(){n(!1)}}),console.log(o)},delete:(o,i,n)=>{n(!0),ae({type:"delMessage",enableNotifications:!0,message:"删除成功",body:{url:`/message.do?operate=delMessage&id=${o}`},then(u){i(u.data)},_finally_(){n(!1)}})},children:S.jsxs(S.Fragment,{children:[S.jsxs(ze,{defaultValue:"UTF-8",style:{width:"150px",marginLeft:"10px"},onChange:t,children:[S.jsx(I,{value:"UTF-8"}),S.jsx(I,{value:"UTF-16"}),S.jsx(I,{value:"GBK"}),S.jsx(I,{value:"ASCII"}),S.jsx(I,{value:"ISO-8859-1"})]}),S.jsxs(ze,{defaultValue:"text",style:{width:"150px",marginLeft:"10px"},onChange:a,children:[S.jsx(I,{value:"text"}),S.jsx(I,{value:"richText"}),S.jsx(I,{value:"markdown"})]})]})})};export{cn as default};
